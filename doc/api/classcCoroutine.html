<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OMNeT++/OMNEST Simulation Library: cCoroutine Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.6 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>cCoroutine Class Reference<br>
<small>
[<a class="el" href="group__Internals.html">Internal classes</a>]</small>
</h1><!-- doxytag: class="cCoroutine" --><code>#include &lt;<a class="el" href="ccoroutine_8h-source.html">ccoroutine.h</a>&gt;</code>
<p>
<a href="classcCoroutine-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Low-level coroutine library. 
<p>
Coroutines are used by <a class="el" href="classcSimpleModule.html">cSimpleModule</a>.<p>
<a class="el" href="classcCoroutine.html">cCoroutine</a> has platform-dependent implementation:<p>
On Windows, it uses the Win32 Fiber API.<p>
On other platforms, the implementation a portable coroutine library, first described by Stig Kofoed ("Portable coroutines", see the Manual for a better reference). It creates all coroutine stacks within the main stack, and uses setjmp()/longjmp() for context switching. This implies that the maximum stack space allowed by the operating system for the OMNeT++ process must be sufficiently high (several, maybe several hundred megabytes), otherwise a segmentation fault will occur. 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcCoroutine.html#a28d47689379f53aada0130ddf07bb4a">setup</a> (<a class="el" href="group__EnumsTypes.html#g5082fb55ece1f2bcc5f8c363940fdd51">CoroutineFnp</a> fnp, void *arg, unsigned stack_size)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcCoroutine.html#03978af1f95966a51d3a09a1446fd863">cCoroutine</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcCoroutine.html#e66f141d8beb3fffb207dba791d02c0e">~cCoroutine</a> ()</td></tr>

<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcCoroutine.html#6f3835cda82e18f034e76eb31a90853e">stackOverflow</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcCoroutine.html#0c0465fde77dae768c3b5a0af2a89f0e">stackSize</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcCoroutine.html#b83fed2d21145cd6e05b0580ba079571">stackUsage</a> () const </td></tr>

<tr><td colspan="2"><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcCoroutine.html#8362bdfd9b2744f9737b0a2a8b869b22">init</a> (unsigned total_stack, unsigned main_stack)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcCoroutine.html#51453982a5de8246527593b960dbcb6c">switchTo</a> (<a class="el" href="classcCoroutine.html">cCoroutine</a> *cor)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcCoroutine.html#9499edcba31be69a71dbe33ea22815c1">switchToMain</a> ()</td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="03978af1f95966a51d3a09a1446fd863"></a><!-- doxytag: member="cCoroutine::cCoroutine" ref="03978af1f95966a51d3a09a1446fd863" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cCoroutine::cCoroutine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructor. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e66f141d8beb3fffb207dba791d02c0e"></a><!-- doxytag: member="cCoroutine::~cCoroutine" ref="e66f141d8beb3fffb207dba791d02c0e" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual cCoroutine::~cCoroutine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Destructor. 
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="8362bdfd9b2744f9737b0a2a8b869b22"></a><!-- doxytag: member="cCoroutine::init" ref="8362bdfd9b2744f9737b0a2a8b869b22" args="(unsigned total_stack, unsigned main_stack)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void cCoroutine::init           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned&nbsp;</td>
          <td class="mdname" nowrap> <em>total_stack</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned&nbsp;</td>
          <td class="mdname" nowrap> <em>main_stack</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initializes the coroutine library. 
<p>
This function has to be called exactly once in a program, possibly at the top of main().     </td>
  </tr>
</table>
<a class="anchor" name="a28d47689379f53aada0130ddf07bb4a"></a><!-- doxytag: member="cCoroutine::setup" ref="a28d47689379f53aada0130ddf07bb4a" args="(CoroutineFnp fnp, void *arg, unsigned stack_size)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool cCoroutine::setup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__EnumsTypes.html#g5082fb55ece1f2bcc5f8c363940fdd51">CoroutineFnp</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>fnp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>arg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned&nbsp;</td>
          <td class="mdname" nowrap> <em>stack_size</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sets up a coroutine. 
<p>
The arguments are the function that should be run in the coroutine, a pointer that is passed to the coroutine function, and the stack size.     </td>
  </tr>
</table>
<a class="anchor" name="6f3835cda82e18f034e76eb31a90853e"></a><!-- doxytag: member="cCoroutine::stackOverflow" ref="6f3835cda82e18f034e76eb31a90853e" args="() const " --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual bool cCoroutine::stackOverflow           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns true if there was a stack overflow during execution of the coroutine. 
<p>
Windows/Fiber API: Not implemented: always returns false.<p>
Portable coroutines: it checks the intactness of a predefined byte pattern (0xdeadbeef) at the stack boundary, and report stack overflow if it was overwritten. The mechanism usually works fine, but occasionally it can be fooled by large uninitialized local variables (e.g. char buffer[256]): if the byte pattern happens to fall in the middle of such a local variable, it may be preserved intact and stack violation is not detected.     </td>
  </tr>
</table>
<a class="anchor" name="0c0465fde77dae768c3b5a0af2a89f0e"></a><!-- doxytag: member="cCoroutine::stackSize" ref="0c0465fde77dae768c3b5a0af2a89f0e" args="() const " --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual unsigned cCoroutine::stackSize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the stack size of the coroutine. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b83fed2d21145cd6e05b0580ba079571"></a><!-- doxytag: member="cCoroutine::stackUsage" ref="b83fed2d21145cd6e05b0580ba079571" args="() const " --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual unsigned cCoroutine::stackUsage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the amount of stack actually used by the coroutine. 
<p>
Windows/Fiber API: Not implemented, always returns 0.<p>
Portable coroutines: It works by checking the intactness of predefined byte patterns (0xdeadbeef) placed in the stack.     </td>
  </tr>
</table>
<a class="anchor" name="51453982a5de8246527593b960dbcb6c"></a><!-- doxytag: member="cCoroutine::switchTo" ref="51453982a5de8246527593b960dbcb6c" args="(cCoroutine *cor)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void cCoroutine::switchTo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classcCoroutine.html">cCoroutine</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cor</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Switch to another coroutine. 
<p>
The execution of the current coroutine is suspended and the other coroutine is resumed from the point it last left off.     </td>
  </tr>
</table>
<a class="anchor" name="9499edcba31be69a71dbe33ea22815c1"></a><!-- doxytag: member="cCoroutine::switchToMain" ref="9499edcba31be69a71dbe33ea22815c1" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void cCoroutine::switchToMain           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Switch to the main coroutine (the one main() runs in). 
<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="ccoroutine_8h-source.html">ccoroutine.h</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Sun Nov 19 13:30:33 2006 for OMNeT++/OMNEST Simulation Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.6 </small></address>
</body>
</html>
